<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>예약 시스템</title>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
</head>

<body>

    <input type="text" id="datepicker" readonly>
    <div id="timeButtonsStart"></div>
    <div id="timeButtonsEnd"></div>
    <button id="reserveButton">예약하기</button>

    <script>
        $(function () {
            let selectedStartDate = null;
            let selectedEndDate = null;
            let selectedStartTime = null;
            let selectedEndTime = null;

            $("#datepicker").datepicker({
                nextText: "다음",
                prevText: "이전",
                monthNames: ["1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월"],
                dayNames: ["일", "월", "화", "수", "목", "금", "토", "일"],
                dayNamesShort: ["일", "월", "화", "수", "목", "금", "토", "일"],
                dayNamesMin: ["일", "월", "화", "수", "목", "금", "토", "일"],
                dateFormat: "yy-mm-dd",
                // showOtherMonths: true,
                // selectOtherMonths: true,
                // changeMonth: true,
                // changeYear: true,
                // yearRange: "1900:2100",
                minDate: 0,
                onSelect: function (dateText, inst) {
                    updateButtonsStart();
                }
            });

            function updateButtonsStart() {
                let timeButtons = "";
                for (let i = 0; i < 24; i++) {
                    timeButtons += '<button class="timeButtonStart" data-hour="' + i + '">' + i +
                        '시</button>';
                }
                $("#timeButtonsStart").html(timeButtons);
            }

            $(document).on("click", ".timeButtonStart", function () {
                selectedStartTime = $(this).data("hour");
                selectedStartDate = $("#datepicker").datepicker("getDate");
                selectedStartDate.setHours(selectedStartTime, 0, 0, 0);
                updateButtonsEnd();
            });

            function updateButtonsEnd() {
                let timeButtons = "";
                for (let i = selectedStartTime + 1; i < 24; i++) {
                    timeButtons += '<button class="timeButtonEnd" data-hour="' + i + '">' + i +
                        '시</button>';
                }
                $("#timeButtonsEnd").html(timeButtons);
            }

            $(document).on("click", ".timeButtonEnd", function () {
                selectedEndTime = $(this).data("hour");
                selectedEndDate = new Date(selectedStartDate);
                selectedEndDate.setHours(selectedEndTime, 0, 0, 0);
            });

            $("#reserveButton").click(function () {
                if (selectedStartDate && selectedStartTime && selectedEndDate && selectedEndTime) {
                    let formattedStartTime = selectedStartDate.toISOString().substr(11, 5);
                    let formattedEndTime = selectedEndDate.toISOString().substr(11, 5);
                    alert("예약이 완료되었습니다.\n시작 시간: " + formattedStartTime + "\n종료 시간: " +
                        formattedEndTime);
                } else {
                    alert("시작 날짜와 시간, 종료 시간을 선택해주세요.");
                }
            });
        });
    </script>

</body>

</html>